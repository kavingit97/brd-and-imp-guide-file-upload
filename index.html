<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COCO-SSD Object Detection</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        img { max-width: 100%; }
        .rectangle { position: absolute; border: 2px solid red; pointer-events: none; }
    </style>
</head>
<body>

<h1>COCO-SSD Object Detection</h1>
<form id="inputForm">
    <input type="file" id="fileInput" accept="image/*" required>
    <button type="submit">Process</button>
</form>

<div id="outputSection" style="position: relative;"></div>

<script>
    document.getElementById('inputForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const fileInput = document.getElementById('fileInput').files[0];
        const reader = new FileReader();
        const outputSection = document.getElementById('outputSection');
        outputSection.innerHTML = ''; // Clear previous output

        reader.onload = async function(e) {
            const imgElement = document.createElement('img');
            imgElement.src = e.target.result;
            outputSection.appendChild(imgElement);

            imgElement.onload = async function() {
                // Load COCO-SSD model
                const model = await cocoSsd.load();
                const predictions = await model.detect(imgElement);

                // Draw rectangles around detected objects
                predictions.forEach(prediction => {
                    drawRectangle(outputSection, prediction.bbox[0], prediction.bbox[1], prediction.bbox[2], prediction.bbox[3]);
                    console.log(`Detected: ${prediction.class} with confidence: ${prediction.score}`);
                });
            };
        };

        reader.readAsDataURL(fileInput); // Read the image file
    });

    function drawRectangle(outputDiv, x, y, width, height) {
        const rect = document.createElement('div');
        rect.className = 'rectangle';
        rect.style.left = `${x}px`;
        rect.style.top = `${y}px`;
        rect.style.width = `${width}px`;
        rect.style.height = `${height}px`;
        outputDiv.appendChild(rect);
    }
</script>

</body>
</html>
